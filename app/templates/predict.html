{% extends "base.html" %}

{% block title %}Predict Rushing Yards{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <div class="card shadow">
                <div class="card-header">
                    <h2 class="h4 mb-0">
                        <i class="bi bi-graph-up-arrow me-2"></i>NFL Rushing Yards Predictor
                    </h2>
                    <small class="text-light opacity-75">Advanced AI-powered rushing prediction</small>
                </div>
                <div class="card-body">
                    <form id="predictionForm" action="javascript:void(0);" method="post" onsubmit="return false;">
                        <div class="row g-3">
                            <!-- Player Information -->
                            <div class="col-12">
                                <h5 class="border-bottom pb-2 mb-3">
                                    <i class="bi bi-person-badge me-2"></i>Player Information
                                </h5>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="playerHeight" class="form-label">Player Height (inches)</label>
                                <input type="number" class="form-control" id="playerHeight" name="playerHeight" min="60" max="90" step="0.5" value="72" required>
                                <div class="form-text">Enter height in inches (e.g., 72 for 6'0")</div>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="playerWeight" class="form-label">Player Weight (lbs)</label>
                                <input type="number" class="form-control" id="playerWeight" name="playerWeight" min="150" max="400" value="220" required>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="playerAge" class="form-label">Player Age</label>
                                <input type="number" class="form-control" id="playerAge" name="playerAge" min="18" max="50" step="0.1" value="25" required>
                            </div>
                            
                            <!-- Play Situation -->
                            <div class="col-12 mt-4">
                                <h5 class="border-bottom pb-2 mb-3">
                                    <i class="bi bi-gear me-2"></i>Play Situation
                                </h5>
                            </div>
                            
                            <div class="col-md-4">
                                <label for="down" class="form-label">Down</label>
                                <select class="form-select" id="down" name="down" required>
                                    <option value="1">1st Down</option>
                                    <option value="2">2nd Down</option>
                                    <option value="3">3rd Down</option>
                                    <option value="4">4th Down</option>
                                </select>
                            </div>
                            
                            <div class="col-md-4">
                                <label for="distance" class="form-label">Yards to Go</label>
                                <input type="number" class="form-control" id="distance" name="distance" min="1" max="99" value="10" required>
                            </div>
                            
                            <div class="col-md-4">
                                <label for="defendersInBox" class="form-label">Defenders in Box</label>
                                <input type="number" class="form-control" id="defendersInBox" name="defendersInBox" min="4" max="11" value="7" required>
                            </div>
                            
                            <!-- Player Metrics -->
                            <div class="col-12 mt-4">
                                <h5 class="border-bottom pb-2 mb-3">
                                    <i class="bi bi-speedometer2 me-2"></i>Player Metrics
                                </h5>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="playerSpeed" class="form-label">Speed (yards/second)</label>
                                <input type="range" class="form-range" id="playerSpeed" name="playerSpeed" min="0" max="10" step="0.1" value="5.5">
                                <div class="d-flex justify-content-between">
                                    <small>0 yds/s</small>
                                    <small id="speedValue">5.5 yds/s</small>
                                    <small>10 yds/s</small>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="playerAccel" class="form-label">Acceleration (yards/second²)</label>
                                <input type="range" class="form-range" id="playerAccel" name="playerAccel" min="0" max="10" step="0.1" value="3.2">
                                <div class="d-flex justify-content-between">
                                    <small>0 yds/s²</small>
                                    <small id="accelValue">3.2 yds/s²</small>
                                    <small>10 yds/s²</small>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="playerDir" class="form-label">Direction (degrees)</label>
                                <input type="range" class="form-range" id="playerDir" name="playerDir" min="0" max="359" value="90">
                                <div class="d-flex justify-content-between">
                                    <small>0°</small>
                                    <small id="dirValue">90°</small>
                                    <small>359°</small>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="playerDis" class="form-label">Distance from Line of Scrimmage (yards)</label>
                                <input type="range" class="form-range" id="playerDis" name="playerDis" min="0" max="20" step="0.1" value="7.5">
                                <div class="d-flex justify-content-between">
                                    <small>0 yds</small>
                                    <small id="disValue">7.5 yds</small>
                                    <small>20 yds</small>
                                </div>
                            </div>
                            
                            <!-- Position -->
                            <div class="col-12 mt-4">
                                <h5 class="border-bottom pb-2 mb-3">
                                <i class="bi bi-geo-alt me-2"></i>Player Position
                            </h5>
                                <div class="football-field position-relative" style="height: 300px;">
                                    <div class="nfl-field-lines"></div>
                                    <div id="playerMarker" class="position-absolute">
                                        <div class="position-relative">
                                            <div class="position-absolute" style="width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent; border-bottom: 15px solid #dc3545; top: -15px; left: 0;"></div>
                                        </div>
                                    </div>
                                    <div class="position-absolute top-50 start-0 end-0 border-top border-bottom border-white" style="height: 3px; opacity: 0.8;"></div>
                                    <div class="position-absolute start-50 top-0 bottom-0 border-start border-end border-white" style="width: 3px; opacity: 0.8;"></div>
                                    <div class="position-absolute top-0 start-0 end-0 bottom-0 d-flex align-items-center justify-content-center">
                                        <p class="text-white fw-bold" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.7); background: rgba(0,0,0,0.3); padding: 8px 16px; border-radius: 20px;">
                                            <i class="bi bi-mouse me-2"></i>Click on the field to position the player
                                        </p>
                                    </div>
                                </div>
                                <input type="hidden" id="xPosition" name="xPosition" value="50">
                                <input type="hidden" id="yPosition" name="yPosition" value="50">
                            </div>
                            
                            <!-- Submit Button -->
                            <div class="col-12 mt-4">
                                <button type="button" id="predictButton" class="btn btn-primary btn-lg w-100">
                                    <span id="submitText">
                                        <i class="bi bi-lightning-charge me-2"></i>Predict Rushing Yards
                                    </span>
                                    <span id="loadingSpinner" class="nfl-loading d-none" role="status" aria-hidden="true"></span>
                                </button>
                                <div class="text-center mt-3">
                                    <div class="nfl-badge">
                                        Powered by Advanced AI
                                    </div>
                                    <div class="mt-3">
                                        <div class="nfl-image-preview">
                                            <img src="{{ url_for('static', path='/img/nfl-hero-image.jpg') }}" alt="NFL Integrity" style="height: 60px; width: auto; border-radius: 8px; opacity: 0.8;">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    
                    <!-- Results -->
                    <div id="predictionResults" class="mt-5 d-none">
                        <h3 class="text-center mb-4">
                            <i class="bi bi-trophy-fill me-2 text-warning"></i>Prediction Results
                        </h3>
                        <div class="card">
                            <div class="card-header">
                                <h4 class="mb-0">
                                    <i class="bi bi-graph-up me-2"></i>Predicted Rushing Yards
                                </h4>
                            </div>
                            <div class="card-body text-center">
                                <div class="display-1 fw-bold text-primary mb-3" id="predictedYards">4.7</div>
                                <div class="progress mb-3" style="height: 30px;">
                                    <div id="yardageBar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                                </div>
                                <div class="row mt-4">
                                    <div class="col-md-6">
                                        <div class="nfl-stats-highlight">
                                            <h6><i class="bi bi-shield-check me-2"></i>Confidence</h6>
                                            <div class="h3 text-success" id="confidenceScore">78%</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="nfl-stats-highlight">
                                            <h6><i class="bi bi-graph-up-arrow me-2"></i>Success Probability</h6>
                                            <div class="h3 text-info" id="successProbability">65%</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-4" id="insights">
                                    <h5>Key Insights</h5>
                                    <ul class="text-start" id="insightsList">
                                        <li>Player's speed is optimal for this play type</li>
                                        <li>Defensive alignment suggests moderate success</li>
                                        <li>Field position is favorable for a running play</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="text-center mt-4">
                            <button id="newPredictionBtn" class="btn btn-outline-primary">
                                <i class="bi bi-arrow-clockwise me-2"></i>Make Another Prediction
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Model Information -->
            <div class="card mt-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="bi bi-cpu me-2"></i>About the Prediction Model
                    </h5>
                </div>
                <div class="card-body">
                    <p>Our prediction model uses advanced machine learning techniques to analyze various factors that influence rushing success in the NFL. The model was trained on thousands of plays from multiple NFL seasons and considers:</p>
                    <ul>
                        <li>Player physical attributes (height, weight, age)</li>
                        <li>Game situation (down, distance, field position)</li>
                        <li>Defensive alignment and personnel</li>
                        <li>Player movement metrics (speed, acceleration, direction)</li>
                    </ul>
                    <p class="mb-0">The model achieves a mean absolute error of 3.42 yards on test data, outperforming traditional statistical models by 28%.</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', path='/js/simple.js') }}" defer></script>
{% endblock %}
